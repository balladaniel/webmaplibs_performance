<!doctype html>

<html>
	<head>
		<meta charset="utf-8">
		<title>Points 500</title>

		<!-- leaflet -->
		<link rel="stylesheet" href="../../../libs/leaflet-1.9.4/leaflet.css" />
		<script src="../../../libs/leaflet-1.9.4/leaflet.js"></script>
		
		<style>
			html, body {
				height: 100%;
				margin: 0;
				font-style: normal;				
			}
			
			#map {
				position: absolute;
				margin:  auto;
				top: 0;
				bottom: 0;
				left: 0;
				right: 0;
			}						
		</style>
	</head>
	<body>		
		<div id="map"></div>	
		<script>

			fileName = location.pathname.split("/").slice(-1)[0].slice(0,-5);

			var OSM = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
				attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
			});
			var map = L.map('map', {layers: [OSM]}); 
			map.attributionControl.setPrefix('<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">Leaflet ' + L.version + '</a>');
			
			var geojsonMarkerOptions = {
				radius: 8,
				fillColor: "#ff7800",
				color: "#000",
				weight: 1,
				opacity: 1,
				fillOpacity: 0.8
			};

			fetch('../../../datasets/points/'+fileName+'.geojson').then(r => r.json()).then(d => {
				let t0 = performance.now();
				testdata = L.geoJSON(d/*, {
					pointToLayer: function (feature, latlng) {
						return L.circleMarker(latlng, geojsonMarkerOptions);
					}}*/);
				testdata.on('add', (e)=> {
					let t1 = performance.now();
					console.log(`Adding to map took: ${t1-t0} ms.`)
					map.whenReady((e) => {
						console.log('whenready')
						let t2 = performance.now();
						console.log(`Adding to map took: ${t2-t0} ms.`)
					});
				});
				testdata.addTo(map);
				map.fitBounds(testdata.getBounds())
			});		

		</script>	
	</body>
</html>